<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DPDK: lib/eal/include/generic/rte_power_intrinsics.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">23.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_128b0d86a58fb45249214ca3dc74cbc9.html">eal</a></li><li class="navelem"><a class="el" href="dir_ae2f63391bb292b7e8558f7d4adaae63.html">include</a></li><li class="navelem"><a class="el" href="dir_1a9fb2c796188042b605d57bf1c55a3d.html">generic</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rte_power_intrinsics.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &lt;<a class="el" href="rte__spinlock_8h_source.html">rte_spinlock.h</a>&gt;</code><br />
</div>
<p><a href="rte__power__intrinsics_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad8bd4912acd69b7bdc5eccaa9db15222"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte__power__intrinsics_8h.html#ad8bd4912acd69b7bdc5eccaa9db15222">RTE_POWER_MONITOR_OPAQUE_SZ</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ad8bd4912acd69b7bdc5eccaa9db15222"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a11ff75bf308aa26c695f11d7a0dd4b1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rte__trace__point_8h.html#a70b6efc30c60e969d7684445cde97b50">typedef</a> int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte__power__intrinsics_8h.html#a11ff75bf308aa26c695f11d7a0dd4b1e">rte_power_monitor_clb_t</a>) (const uint64_t val, const uint64_t opaque[<a class="el" href="rte__power__intrinsics_8h.html#ad8bd4912acd69b7bdc5eccaa9db15222">RTE_POWER_MONITOR_OPAQUE_SZ</a>])</td></tr>
<tr class="separator:a11ff75bf308aa26c695f11d7a0dd4b1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a63f8cac3d0dc965591881b9cb3b7af34"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte__power__intrinsics_8h.html#a63f8cac3d0dc965591881b9cb3b7af34">rte_power_monitor</a> (const struct rte_power_monitor_cond *pmc, const uint64_t tsc_timestamp)</td></tr>
<tr class="separator:a63f8cac3d0dc965591881b9cb3b7af34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a933ca57b0aad4f37d8c3e9624e4ea902"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte__power__intrinsics_8h.html#a933ca57b0aad4f37d8c3e9624e4ea902">rte_power_monitor_wakeup</a> (const unsigned int lcore_id)</td></tr>
<tr class="separator:a933ca57b0aad4f37d8c3e9624e4ea902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2608acdc6433776855e0985012faf5ca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte__power__intrinsics_8h.html#a2608acdc6433776855e0985012faf5ca">rte_power_pause</a> (const uint64_t tsc_timestamp)</td></tr>
<tr class="separator:a2608acdc6433776855e0985012faf5ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fcf6e8c41c5b04eb12d82ab65ed05a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte__power__intrinsics_8h.html#a4fcf6e8c41c5b04eb12d82ab65ed05a7">rte_power_monitor_multi</a> (const struct rte_power_monitor_cond pmc[], const uint32_t num, const uint64_t tsc_timestamp)</td></tr>
<tr class="separator:a4fcf6e8c41c5b04eb12d82ab65ed05a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Advanced power management operations.</p>
<p>This file define APIs for advanced power management, which are architecture-dependent. </p>

<p class="definition">Definition in file <a class="el" href="rte__power__intrinsics_8h_source.html">rte_power_intrinsics.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad8bd4912acd69b7bdc5eccaa9db15222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8bd4912acd69b7bdc5eccaa9db15222">&#9670;&nbsp;</a></span>RTE_POWER_MONITOR_OPAQUE_SZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RTE_POWER_MONITOR_OPAQUE_SZ&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Size of the opaque data in monitor condition </p>

<p class="definition">Definition at line <a class="el" href="rte__power__intrinsics_8h_source.html#l00021">21</a> of file <a class="el" href="rte__power__intrinsics_8h_source.html">rte_power_intrinsics.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a11ff75bf308aa26c695f11d7a0dd4b1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11ff75bf308aa26c695f11d7a0dd4b1e">&#9670;&nbsp;</a></span>rte_power_monitor_clb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rte__trace__point_8h.html#a70b6efc30c60e969d7684445cde97b50">typedef</a> int(* rte_power_monitor_clb_t) (const uint64_t val, const uint64_t opaque[<a class="el" href="rte__power__intrinsics_8h.html#ad8bd4912acd69b7bdc5eccaa9db15222">RTE_POWER_MONITOR_OPAQUE_SZ</a>])</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Callback definition for monitoring conditions. Callbacks with this signature will be used by <code><a class="el" href="rte__power__intrinsics_8h.html#a63f8cac3d0dc965591881b9cb3b7af34">rte_power_monitor()</a></code> to check if the entering of power optimized state should be aborted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">val</td><td>The value read from memory. </td></tr>
    <tr><td class="paramname">opaque</td><td>Callback-specific data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if entering of power optimized state should proceed -1 if entering of power optimized state should be aborted </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte__power__intrinsics_8h_source.html#l00037">37</a> of file <a class="el" href="rte__power__intrinsics_8h_source.html">rte_power_intrinsics.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a63f8cac3d0dc965591881b9cb3b7af34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63f8cac3d0dc965591881b9cb3b7af34">&#9670;&nbsp;</a></span>rte_power_monitor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rte_power_monitor </td>
          <td>(</td>
          <td class="paramtype">const struct rte_power_monitor_cond *&#160;</td>
          <td class="paramname"><em>pmc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>tsc_timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Monitor specific address for changes. This will cause the CPU to enter an architecture-defined optimized power state until either the specified memory address is written to, a certain TSC timestamp is reached, or other reasons cause the CPU to wake up.</p>
<p>Additionally, an expected value (<code>pmc-&gt;val</code>), mask (<code>pmc-&gt;mask</code>), and data size (<code>pmc-&gt;size</code>) are provided in the <code>pmc</code> power monitoring condition. If the mask is non-zero, the current value pointed to by the <code>pmc-&gt;addr</code> pointer will be read and compared against the expected value, and if they match, the entering of optimized power state will be aborted. This is intended to prevent the CPU from entering optimized power state and waiting on a write that has already happened by the time this API is called.</p>
<dl class="section warning"><dt>Warning</dt><dd>It is responsibility of the user to check if this function is supported at runtime using <code><a class="el" href="rte__cpuflags_8h.html#aa9397c2b624f81967241da45c2b7510d">rte_cpu_get_intrinsics_support()</a></code> API call.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pmc</td><td>The monitoring condition structure. </td></tr>
    <tr><td class="paramname">tsc_timestamp</td><td>Maximum TSC timestamp to wait for. Note that the wait behavior is architecture-dependent.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success -EINVAL on invalid parameters -ENOTSUP if unsupported </dd></dl>

</div>
</div>
<a id="a933ca57b0aad4f37d8c3e9624e4ea902"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a933ca57b0aad4f37d8c3e9624e4ea902">&#9670;&nbsp;</a></span>rte_power_monitor_wakeup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rte_power_monitor_wakeup </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>lcore_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wake up a specific lcore that is in a power optimized state and is monitoring an address.</p>
<dl class="section note"><dt>Note</dt><dd>It is safe to call this function if the lcore in question is not sleeping. The function will have no effect.</dd>
<dd>
This function will <em>not</em> wake up a core that is in a power optimized state due to calling <code>rte_power_pause</code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lcore_id</td><td>Lcore ID of a sleeping thread. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2608acdc6433776855e0985012faf5ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2608acdc6433776855e0985012faf5ca">&#9670;&nbsp;</a></span>rte_power_pause()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rte_power_pause </td>
          <td>(</td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>tsc_timestamp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enter an architecture-defined optimized power state until a certain TSC timestamp is reached.</p>
<dl class="section warning"><dt>Warning</dt><dd>It is responsibility of the user to check if this function is supported at runtime using <code><a class="el" href="rte__cpuflags_8h.html#aa9397c2b624f81967241da45c2b7510d">rte_cpu_get_intrinsics_support()</a></code> API call.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tsc_timestamp</td><td>Maximum TSC timestamp to wait for. Note that the wait behavior is architecture-dependent.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success -EINVAL on invalid parameters -ENOTSUP if unsupported </dd></dl>

</div>
</div>
<a id="a4fcf6e8c41c5b04eb12d82ab65ed05a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fcf6e8c41c5b04eb12d82ab65ed05a7">&#9670;&nbsp;</a></span>rte_power_monitor_multi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rte_power_monitor_multi </td>
          <td>(</td>
          <td class="paramtype">const struct rte_power_monitor_cond&#160;</td>
          <td class="paramname"><em>pmc</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>tsc_timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Monitor a set of addresses for changes. This will cause the CPU to enter an architecture-defined optimized power state until either one of the specified memory addresses is written to, a certain TSC timestamp is reached, or other reasons cause the CPU to wake up.</p>
<p>Additionally, <code>expected</code> 64-bit values and 64-bit masks are provided. If mask is non-zero, the current value pointed to by the <code>p</code> pointer will be checked against the expected value, and if they do not match, the entering of optimized power state may be aborted.</p>
<dl class="section warning"><dt>Warning</dt><dd>It is responsibility of the user to check if this function is supported at runtime using <code><a class="el" href="rte__cpuflags_8h.html#aa9397c2b624f81967241da45c2b7510d">rte_cpu_get_intrinsics_support()</a></code> API call. Failing to do so may result in an illegal CPU instruction error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pmc</td><td>An array of monitoring condition structures. </td></tr>
    <tr><td class="paramname">num</td><td>Length of the <code>pmc</code> array. </td></tr>
    <tr><td class="paramname">tsc_timestamp</td><td>Maximum TSC timestamp to wait for. Note that the wait behavior is architecture-dependent.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success -EINVAL on invalid parameters -ENOTSUP if unsupported </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
